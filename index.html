<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Possibility for electricity autarky in Europe</title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js'></script>
    <script src='style.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
    integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
    crossorigin="anonymous">
    <link rel="stylesheet" href="map.css">
</head>

<body>
    <div id='map'></div>
    <div class='map-overlay' id='features'>
        <h3>Can my municipality supply itself with electricity from sun and wind?</h3>
        <h2>Renewable electricity autarky</h2>
        <div id='pd'>
            <p>
                Hover over an area for details<br>
                Zoom to switch administrative levels.<br>
                Click on  <i class="fas fa-info-circle"></i> for more information.<br>
            </p>
        </div>
        <div id='buttons'>
            <div class="tooltip">
                <i onclick="showInfo()" class="fas fa-info-circle"></i>
                <span class="tooltiptext">About the map</span>
            </div>
            <a class="tooltip" href="https://doi.org/10.1016/j.esr.2019.100388" target="_blank">
                <i class="fas fa-book-open"></i>
                <span class="tooltiptext">Read publication</span>
            </a>
            <a class="tooltip" href="https://doi.org/10.5281/zenodo.3244984" target="_blank">
                <i class="fas fa-database"></i>
                <span class="tooltiptext">Download data</span>
            </a>
            <a class="tooltip" href="https://www.iass-potsdam.de/en/research-group/energy-transition-dynamics" target="_blank">
                <i class="fas fa-user-circle"></i>
                <span class="tooltiptext">Research group</span>
            </a>
            <a class="tooltip" href="https://github.com/timtroendle/possibility-for-electricity-autarky-map/issues/new" target="_blank">
                <i class="fas fa-flag"></i>
                <span class="tooltiptext">Report an issue</span>
            </a>
        </div>
    </div>
    <div class='map-overlay' id='legend'>
        <h2>Autarky is</h2>
    </div>
    <div class='map-overlay' id="info" onclick="hideInfo()">
        <div id="infotext">
            <p>

            </p>
            <h1>Can my municipality supply itself with electricity from sun and wind?</h1>
            <p>
                This map visualises the possibility for renewable electricity autarky in Europe ---
                for all municipalities, all regions, all countries, and all of Europe. 
                No matter where you live, here you can find out whether enough electricity from 
                the sun and wind can be generated in your region.
            </p>
            <h2>But what does it mean to be autark / self-sufficient?</h2>
            <p>   
                Possibility for autarky means being able to fulfil local electricity demand with
                100% renewable electricity from solar and wind power generated locally. 
                It makes it possible for entire communities to produce their own electricity - for
                example using solar systems on the roofs and community wind farms - and then consume it.
            </p>
            <h2>Can Europe be powered by sun and wind alone?</h2>
            <p>
                The potential of wind and solar energy is large enough to supply Europe with 100%
                renewable electricity. In many cases at regional or local level, self-sufficiency is
                possible using renewable electricity only. However, in particular densely populated
                metropolis will not be able to supply themselves with 100% renewable electricity.
                Surrounding regions can may cover their needs.
            </p>
            <h2>What does the map show me?</h2>
            <p>
                The map shows the potential for renewable electricity self-sufficiency in Europe for
                individual countries, federal states and municipalities. The potential shown is based on
                technical and social constraints: for example, we do not allow electricity to be
                produced in environmentally protected areas and we also prohibit open field solar
                systems on arable land. Therefore, we call this potential the “technical-social
                potential”. You can find more information in our scientific article (information below). 
            </p>
            <p>
                We used different colours to represent the possibilities for a self-sufficient power
                supply. We consider self-sufficiency here as impossible only if the local electricity
                demand exceeds the technical potential:
                <ul>
                    <li>Autarky is likely possible (dark green), when the potential exceeds demand.</li>
                    <li>Autarky may be possible (light green), when demand exceeds the potential,
                        but technical potential is more than twice the demand.</li>
                    <li>Autarky is likely impossible (light red), when demand exceeds the potential,
                        and technical potential is less than twice the demand.</li>
                    <li>Autarky is impossible (dark red), when demand exceeds technical potential.</li>
                </ul>
            </p>
            <h2>How do I use the map?</h2>
            <p>
                You can zoom in and out to find out about the potential for renewable electricity
                generation and whether the region can supply itself with it.
                Depending on the region you look at, you will notice that the colour of the area may
                change: from dark green - areas in which self-sufficiency is likely - to dark red
                - areas in which self-sufficiency is not possible. If you hoover over the area of ​​your
                choice, you will receive further information in a white field at the top right: You will
                be shown whether electrical self-sufficiency is possible, for example, in the state of
                Brandenburg in Germany, where our institute is based. You can also see how many people
                live there, how much electricity they need and the potential to produce electricity from the sun and wind. Have fun trying it out!
            </p>
            <h2>Where do I get more information about the project?</h2>
            <p>
                In our scientific article you will find more background information on the data and the
                method: <a href=https://doi.org/10.1016/j.esr.2019.100388>Tröndle, T., Pfenninger, S., Lilliestam, J., 2019. Home-made or imported: on the possibility for renewable electricity autarky on all scales in Europe. Energy Strategy Reviews 26.</a>. If you have the scientific data in the article, please quote it.

                You can find out more about us and the research of our working group <a href=https://www.iass-potsdam.de/en/research-group/energy-transition-dynamics>Energy Transition Dynamics</a></q> of the at the Institute for Transformative Sustainability Research (IASS)
                Potsdam on our website.   
            </p>
            <p>
                Did you find an issue in the data? Please
                <a href="https://github.com/timtroendle/possibility-for-electricity-autarky-map/issues/new">
                    report it.
                </a>
            </p>
            <p>
                © 2018-2019 Tim Tröndle, Institute for Advanced Sustainability Studies Potsdam and Institute for Environmental Decisions, ETH Zürich
            </p>
        </div>
    </div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidGltdHJvZW5kbGUiLCJhIjoiY2pxYXRvcHp0M2NidTN4cDMxdXdmZ2VpZSJ9.Yt-BUdLmsq9d4wjDxEWd_g';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/timtroendle/cjqhsfrmz0nb82rqcsk6z8po6'
        });
        map.addControl(new mapboxgl.ScaleControl({unit: 'metric'}));
        map.on('load', function() {

            styleMap(map);

            map.on('mousemove', function(e) {
            var unit = map.queryRenderedFeatures(e.point, {
                layers: ['continental', 'national', 'regional', 'municipal']
            });

            if (unit.length > 0) {
                var potential = unit[0].properties.total_potential_twh_per_year
                var energy_unit = "TWh"
                var demand = unit[0].properties.demand_twh_per_year
                var statement = unit[0].properties.our_rating
                if (potential < 0.1 | demand < 0.1) {
                    potential = potential * 1000
                    demand = demand * 1000
                    energy_unit = "GWh"
                }
                document.getElementById('pd').innerHTML =
                    '<p>in <strong>' + unit[0].properties.name + '</strong> ' +
                    statement + '.</p>' +
                    '<p><strong>' + unit[0].properties.population_sum.toLocaleString('en', {maximumFractionDigits : 0}) + '</strong> people<br>' +
                    '<strong>' + demand.toLocaleString('en', {maximumFractionDigits : 1}) + '</strong> ' + energy_unit + ' electricity demand<br>' +
                    '<strong>' + potential.toLocaleString('en', {maximumFractionDigits : 1}) + '</strong> ' + energy_unit + ' generation potential<br>';
            } else {
                document.getElementById('pd').innerHTML = `
                <p>
                    Hover over an area for details<br>
                    Zoom to switch administrative levels.<br>
                    Click on  <i class="fas fa-info-circle"></i> for more information.<br>
                </p>`;
            }
            });

            var hoveredStateContinentId =  null;
            var hoveredStateNationId =  null;
            var hoveredStateRegionId =  null;
            var hoveredStateMunicipalityId =  null;
            // When the user moves their mouse over the state-fill layer, we'll update the
            // feature state for the feature under the mouse.
            map.on("mousemove", "continental", function(e) {
                if (e.features.length > 0) {
                    if (hoveredStateContinentId) {
                        map.setFeatureState({source: 'continental', sourceLayer: 'continentaltechnicalsocialpotential', id: hoveredStateContinentId}, { hover: false});
                    }
                    hoveredStateContinentId = e.features[0].id;
                    map.setFeatureState({source: 'continental', sourceLayer: 'continentaltechnicalsocialpotential', id: hoveredStateContinentId}, { hover: true});
                }
            });
            map.on("mouseleave", "continental", function() {
                if (hoveredStateContinentId) {
                    map.setFeatureState({source: 'continental', sourceLayer: 'continentaltechnicalsocialpotential', id: hoveredStateContinentId}, { hover: false});
                }
                hoveredStateContinentId =  null;
            });
            map.on("mousemove", "national", function(e) {
                if (e.features.length > 0) {
                    if (hoveredStateNationId) {
                        map.setFeatureState({source: 'national', sourceLayer: 'nationaltechnicalsocialpotential', id: hoveredStateNationId}, { hover: false});
                    }
                    hoveredStateNationId = e.features[0].id;
                    map.setFeatureState({source: 'national', sourceLayer: 'nationaltechnicalsocialpotential', id: hoveredStateNationId}, { hover: true});
                }
            });
            map.on("mouseleave", "national", function() {
                if (hoveredStateNationId) {
                    map.setFeatureState({source: 'national', sourceLayer: 'nationaltechnicalsocialpotential', id: hoveredStateNationId}, { hover: false});
                }
                hoveredStateNationId =  null;
            });
            map.on("mousemove", "regional", function(e) {
                if (e.features.length > 0) {
                    if (hoveredStateRegionId) {
                        map.setFeatureState({source: 'regional', sourceLayer: 'regionaltechnicalsocialpotential', id: hoveredStateRegionId}, { hover: false});
                    }
                    hoveredStateRegionId = e.features[0].id;
                    map.setFeatureState({source: 'regional', sourceLayer: 'regionaltechnicalsocialpotential', id: hoveredStateRegionId}, { hover: true});
                }
            });
            map.on("mouseleave", "regional", function() {
                if (hoveredStateRegionId) {
                    map.setFeatureState({source: 'regional', sourceLayer: 'regionaltechnicalsocialpotential', id: hoveredStateRegionId}, { hover: false});
                }
                hoveredStateRegionId =  null;
            });
            map.on("mousemove", "municipal", function(e) {
                if (e.features.length > 0) {
                    if (hoveredStateMunicipalityId) {
                        map.setFeatureState({source: 'municipal', sourceLayer: 'municipaltechnicalsocialpotential', id: hoveredStateMunicipalityId}, { hover: false});
                    }
                    hoveredStateMunicipalityId = e.features[0].id;
                    map.setFeatureState({source: 'municipal', sourceLayer: 'municipaltechnicalsocialpotential', id: hoveredStateMunicipalityId}, { hover: true});
                }
            });
            map.on("mouseleave", "municipal", function() {
                if (hoveredStateMunicipalityId) {
                    map.setFeatureState({source: 'municipal', sourceLayer: 'municipaltechnicalsocialpotential', id: hoveredStateMunicipalityId}, { hover: false});
                }
                hoveredStateMunicipalityId =  null;
            });

        });

        map.getCanvas().style.cursor = 'default';
        map.fitBounds([[-15.8, 30], [37, 72]]);

        var layers = ['likely possible', 'maybe possible', 'likely impossible', 'impossible'];
        var colors = [COLOR_LIKELY_POSSIBLE, COLOR_MAYBE_POSSIBLE, COLOR_LIKELY_IMPOSSIBLE, COLOR_IMPOSSIBLE];

        for (i = 0; i < layers.length; i++) {
            var layer = layers[i];
            var color = colors[i];
            var item = document.createElement('div');
            var key = document.createElement('span');
            key.className = 'legend-key';
            key.style.backgroundColor = color;

            var value = document.createElement('span');
            value.innerHTML = layer;
            item.appendChild(key);
            item.appendChild(value);
            legend.appendChild(item);
        }

        function showInfo() {
            document.getElementById("info").style.display = "block";
        }

        function hideInfo() {
            document.getElementById("info").style.display = "none";
        }
    </script>
</body>

</html>
